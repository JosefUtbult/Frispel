{% extends "base.html" %}
{% load static %}
{% block content %}
<div class="home-img" style="
  background-image: url('{% static 'drums.jpeg' %}');
  background-position: top center;
  background-size: cover;
  height: 50vh;
  background-attachment: scroll;
"></div>

<script>
(function(){
  const el = document.querySelector('.home-img');
  if (!el) return;

  // kör bara parallax på desktop / stora skärmar
  const desktopMQ = window.matchMedia('(min-width: 1442px)');
  let rafId = null;
  const speed = 0.5; // justera (0.1-0.6)

  function applyParallax() {
    // säkerställ att elementet finns och vi är på desktop
    if (!desktopMQ.matches) return;
    const offset = window.scrollY * speed;
    // sätter bakgrundens Y-position i pixlar (kan vara negativ)
    el.style.backgroundPosition = `center ${-offset}px`;
  }

  function onScroll() {
    if (rafId === null) {
      rafId = requestAnimationFrame(function() {
        applyParallax();
        rafId = null;
      });
    }
  }

  // event listeners - passiva för bättre scrollprestanda
  window.addEventListener('scroll', onScroll, { passive: true });

  // reagera på media query-förändring (resize): start/stop + återställ värden
  function mqChange(e) {
    if (e.matches) {
      // blev desktop -> kör en gång för att positionera korrekt
      applyParallax();
    } else {
      // blev mobil/tablet -> återställ så bilden är statisk och visas från toppen
      el.style.backgroundPosition = 'top center';
    }
  }

  if (desktopMQ.addEventListener) {
    desktopMQ.addEventListener('change', mqChange);
  } else if (desktopMQ.addListener) { // äldre browser fallback
    desktopMQ.addListener(mqChange);
  }

  // initialt läge
  if (!desktopMQ.matches) {
    el.style.backgroundPosition = 'top center';
  } else {
    applyParallax();
  }

})();
</script>

{% comment %}<div class="message">{% endcomment %}
	{% comment %}<p>{% block message %}{% endblock %}</p>{% endcomment %}
{% comment %}</div>{% endcomment %}

<div class="m-5">
	<h3>{% block hed2 %}{% endblock %}
</div>
<p>
	{% block par1 %}{% endblock %}
</p>
<p>
	{% block par2 %}{% endblock %}
</p>
<p>
	{% block par3 %}{% endblock %}
</p>
<div class="my-6">
	<hr>
</div>
<h3 class="m-5">{% block hed3 %}{% endblock %}</h3>
<p>
	{% block par4 %}{% endblock %}<a href="mailto:frispel.ordforande@gmail.com">{% block chairman_mail %}{% endblock %}</a>{% block par5 %}{% endblock %}<a href="https://www.facebook.com/LTUFrispel">{% block facebook %}{% endblock %}</a>.
</p>
{% endblock %}
